!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("@material-ui/core"),require("class-autobind"),require("react-color"),require("clsx"),require("react-select"),require("@material-ui/core/styles"),require("@material-ui/core/MenuItem"),require("@material-ui/icons"),require("prop-types"),require("@material-ui/core/InputAdornment"),require("@material-ui/core/SvgIcon"),require("lodash/isBoolean"),require("@material-ui/core/CircularProgress"),require("@material-ui/core/Button"),require("@material-ui/core/Table"),require("@material-ui/core/TableBody"),require("@material-ui/core/TableCell"),require("@material-ui/core/TableHead"),require("@material-ui/core/TableRow"),require("@material-ui/core/Paper"),require("@material-ui/styles"),require("lodash"),require("@material-ui/core/TablePagination"),require("@material-ui/core/Chip"),require("redux-form"),require("@material-ui/icons/Clear"),require("@material-ui/icons/AddCircle"),require("@material-ui/core/Typography/Typography"),require("react-redux"),require("react-datepicker"),require("react-datepicker/dist/react-datepicker.css")):"function"==typeof define&&define.amd?define(["exports","react","@material-ui/core","class-autobind","react-color","clsx","react-select","@material-ui/core/styles","@material-ui/core/MenuItem","@material-ui/icons","prop-types","@material-ui/core/InputAdornment","@material-ui/core/SvgIcon","lodash/isBoolean","@material-ui/core/CircularProgress","@material-ui/core/Button","@material-ui/core/Table","@material-ui/core/TableBody","@material-ui/core/TableCell","@material-ui/core/TableHead","@material-ui/core/TableRow","@material-ui/core/Paper","@material-ui/styles","lodash","@material-ui/core/TablePagination","@material-ui/core/Chip","redux-form","@material-ui/icons/Clear","@material-ui/icons/AddCircle","@material-ui/core/Typography/Typography","react-redux","react-datepicker","react-datepicker/dist/react-datepicker.css"],t):t((e=e||self)["material-ui-form-helpers"]={},e.React,e.core,e.autobind,e.reactColor,e.clsx,e.Select,e.styles$3,e.MenuItem,e.icons,e.PropTypes,e.InputAdornment,e.AccountCircle,e.isBoolean,e.CircularProgress,e.Button,e.Table$1,e.TableBody,e.TableCell,e.TableHead,e.TableRow,e.Paper,e.styles$4,e._,e.TablePagination,e.Chip,e.reduxForm,e.ClearIcon,e.AddCircleIcon,e.Typography,e.reactRedux,e.DatePicker)}(this,function(e,t,r,n,a,o,i,l,u,c,s,p,d,f,m,h,b,y,g,v,P,C,E,O,k,w,F,x,S,T,D,j){"use strict";var I="default"in t?t.default:t;function R(e){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function q(e,t,r,n,a,o,i){try{var l=e[o](i),u=l.value}catch(e){return void r(e)}l.done?t(u):Promise.resolve(u).then(n,a)}function N(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function i(e){q(o,n,a,i,l,"next",e)}function l(e){q(o,n,a,i,l,"throw",e)}i(void 0)})}}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function V(e,t,r){return t&&B(e.prototype,t),r&&B(e,r),e}function A(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M(){return(M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?z(r,!0).forEach(function(t){A(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function L(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W(e,t)}function H(e){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function W(e,t){return(W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function U(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function $(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function X(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?$(e):t}function J(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}n=n&&n.hasOwnProperty("default")?n.default:n,o=o&&o.hasOwnProperty("default")?o.default:o,i=i&&i.hasOwnProperty("default")?i.default:i,u=u&&u.hasOwnProperty("default")?u.default:u,s=s&&s.hasOwnProperty("default")?s.default:s,p=p&&p.hasOwnProperty("default")?p.default:p,d=d&&d.hasOwnProperty("default")?d.default:d,f=f&&f.hasOwnProperty("default")?f.default:f,m=m&&m.hasOwnProperty("default")?m.default:m,h=h&&h.hasOwnProperty("default")?h.default:h,b=b&&b.hasOwnProperty("default")?b.default:b,y=y&&y.hasOwnProperty("default")?y.default:y,g=g&&g.hasOwnProperty("default")?g.default:g,v=v&&v.hasOwnProperty("default")?v.default:v,P=P&&P.hasOwnProperty("default")?P.default:P,C=C&&C.hasOwnProperty("default")?C.default:C,O=O&&O.hasOwnProperty("default")?O.default:O,k=k&&k.hasOwnProperty("default")?k.default:k,w=w&&w.hasOwnProperty("default")?w.default:w,x=x&&x.hasOwnProperty("default")?x.default:x,S=S&&S.hasOwnProperty("default")?S.default:S,T=T&&T.hasOwnProperty("default")?T.default:T,j=j&&j.hasOwnProperty("default")?j.default:j;var K=function(e){function t(e){var r;return _(this,t),r=X(this,H(t).call(this,e)),n($(r)),r.state={checked:!!e.checked},r}return L(t,I.Component),V(t,[{key:"handleChange",value:function(e){this.props.onChange(e),this.setState({checked:!this.state.checked})}},{key:"render",value:function(){var e=this.props,t=e.label,n=e.name;return I.createElement(r.FormControlLabel,{control:I.createElement(r.Checkbox,{checked:this.state.checked,color:"default",onChange:this.handleChange,value:n}),label:t})}}]),t}(),Q=function(e){function t(e){var r;return _(this,t),A($(r=X(this,H(t).call(this,e))),"handleColorChangeComplete",function(e){r.props.input.onBlur(e.hex),r.toggleColorPicker()}),A($(r),"handleInputChange",function(e){r.props.input.onBlur(e.target.value)}),n($(r)),r.state={openColorPicker:!1},r}return L(t,I.Component),V(t,[{key:"toggleColorPicker",value:function(){this.setState({openColorPicker:!this.state.openColorPicker})}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.input,o=e.label,i=e.placeholder,l=this.state.openColorPicker;return I.createElement("div",{className:t.colorField},I.createElement(r.TextField,{margin:"dense",name:n.name,id:n.id,value:n.value,label:o,type:"text",placeholder:i,onChange:this.handleInputChange}),I.createElement("div",{className:t.colorDiv,style:{backgroundColor:n.value},onClick:this.toggleColorPicker}),l&&I.createElement(a.SketchPicker,{className:t.colorPicker,color:n.value,onChangeComplete:this.handleColorChangeComplete}))}}]),t}(),Y=r.withStyles(function(e){return{title:{width:"500px",backgroundColor:"#edeeef"},colorField:{display:"flex",flexDirection:"row"},colorDiv:{marginTop:"15px",marginBottom:"4px",width:"38px",height:"38px",marginLeft:"10px",border:"1px solid #edeeef",display:"flex-inline"},colorPicker:{position:"absolute",left:"155px",top:"25px",zIndex:1},colorWrapper:{display:"flex",alignItems:"center"},notes:{width:"100%"}}})(Q),Z=r.makeStyles(function(e){return{root:{flexGrow:1,height:250},input:{display:"flex",padding:0,height:"auto"},valueContainer:{display:"flex",flexWrap:"wrap",flex:1,alignItems:"center",overflow:"hidden"},chip:{margin:e.spacing(.5,.25)},chipFocused:{backgroundColor:l.emphasize("light"===e.palette.type?e.palette.grey[300]:e.palette.grey[700],.08)},noOptionsMessage:{padding:e.spacing(1,2)},singleValue:{fontSize:16},placeholder:{position:"absolute",left:2,bottom:6,fontSize:16},paper:{position:"absolute",zIndex:1,marginTop:e.spacing(1),left:0,right:0},divider:{height:e.spacing(2)}}});function ee(e){return I.createElement(r.Typography,M({color:"textSecondary",className:e.selectProps.classes.noOptionsMessage},e.innerProps),e.children)}function te(e){var t=e.inputRef,r=U(e,["inputRef"]);return I.createElement("div",M({ref:t},r))}function re(e){var t=e.children,n=e.innerProps,a=e.innerRef,o=e.selectProps,i=o.classes,l=o.TextFieldProps;return I.createElement(r.TextField,M({fullWidth:!0,InputProps:{inputComponent:te,inputProps:G({className:i.input,ref:a,children:t},n)}},l))}function ne(e){return I.createElement(r.Typography,M({color:"textSecondary",className:e.selectProps.classes.placeholder},e.innerProps),e.children)}function ae(e){return I.createElement(r.Typography,M({className:e.selectProps.classes.singleValue},e.innerProps),e.children)}function oe(e){return I.createElement("div",{className:e.selectProps.classes.valueContainer},e.children)}function ie(e){return I.createElement(r.Chip,{tabIndex:-1,label:e.children,className:o(e.selectProps.classes.chip,A({},e.selectProps.classes.chipFocused,e.isFocused)),onDelete:e.removeProps.onClick,deleteIcon:I.createElement(c.Cancel,e.removeProps)})}function le(e){return I.createElement(r.Paper,M({square:!0,className:e.selectProps.classes.paper},e.innerProps),e.children)}ee.propTypes={children:s.node,innerProps:s.object,selectProps:s.object.isRequired},te.propTypes={inputRef:s.oneOfType([s.func,s.object])},re.propTypes={children:s.node,innerProps:s.object,innerRef:s.oneOfType([s.func,s.object]),selectProps:s.object.isRequired},s.node,s.object,s.oneOfType([s.func,s.object]),s.bool,s.bool,ne.propTypes={children:s.node,innerProps:s.object,selectProps:s.object.isRequired},ae.propTypes={children:s.node,innerProps:s.object,selectProps:s.object.isRequired},oe.propTypes={children:s.node,selectProps:s.object.isRequired},ie.propTypes={children:s.node,isFocused:s.bool,removeProps:s.object.isRequired,selectProps:s.object.isRequired},le.propTypes={children:s.node,innerProps:s.object,selectProps:s.object};var ue={Control:re,Menu:le,MultiValue:ie,NoOptionsMessage:ee,Placeholder:ne,SingleValue:ae,ValueContainer:oe};function ce(e){var r=Z(),n=l.useTheme(),a=J(I.useState(null),2),o=(a[0],a[1]),u=J(I.useState(null),2),c=(u[0],u[1]),s=J(I.useState(null),2),m=s[0],h=s[1];t.useEffect(function(){e.onMount&&(h(!0),e.onMount().then(function(){h(!1)}))},[]),t.useEffect(function(){e.hasOwnProperty("loading")&&f(e.loading)&&h(e.loading)});var b={input:function(e){return G({},e,{color:n.palette.text.primary,"& input":{font:"inherit"}})}},y=e.id?"react-select-".concat(e.id):"react-select-".concat(e.name),g=e.defaultValue?{value:e.defaultValue,label:e.defaultValue}:"";return I.createElement(i,M({},e,{value:e.input.value||g,isDisabled:e.disabled,classes:r,styles:b,inputId:y,isLoading:m,TextFieldProps:{error:e.error,label:e.label,InputLabelProps:{htmlFor:y,shrink:!0,error:e.error},placeholder:e.placeholder,disabled:e.disabled},InputProps:{startAdornment:I.createElement(p,{position:"start"},I.createElement(d,null))},options:e.options||[],components:ue,onChange:e.isMulti?function(t){c(t),e.input.onChange(t)}:function(t){o(t),e.input.onChange(t)},onBlur:function(){return e.input.onBlur(e.input.value)}}))}var se=l.makeStyles(function(e){return{progress:{marginRight:e.spacing()},buttonRoot:{marginRight:e.spacing(2)}}}),pe=function(e){var t=se(),r=e.isSubmitting,n=e.sizeCircularProgress,a=e.colorCircularProgress,o=U(e,["isSubmitting","sizeCircularProgress","colorCircularProgress"]);return I.createElement(h,M({type:"submit",className:t.buttonRoot},o),function(e,r,n){return e?I.createElement(m,{size:r,className:t.progress,color:n}):null}(r,n,a),e.children)};pe.propTypes={isSubmitting:s.bool,variant:s.string,color:s.string,sizeCircularProgress:s.number,colorCircularProgress:s.string},pe.defaultProps={variant:"outlined",color:"primary",sizeCircularProgress:20,colorCircularProgress:"inherit"};var de=E.makeStyles({root:{position:"absolute",width:"100%",height:"100%",top:0,left:0,display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden"},overlay:{position:"absolute",opacity:.3,backgroundColor:"#CCCCCC",width:"100%",height:"100%"}}),fe=function(){var e=de();return I.createElement(I.Fragment,null,I.createElement("div",{className:e.root},I.createElement("div",{className:e.overlay}),I.createElement(r.CircularProgress,null)))},me=E.makeStyles({root:{fontSize:"16px",fontWeight:600}}),he=function(e){var t=me();return I.createElement(v,null,I.createElement(P,null,I.createElement(g,{colSpan:e.colSpan,className:t.root},e.sectionLabel)))};he.defaultProps={colspan:2},he.propTypes={sectionLabel:s.string.isRequired,colSpan:s.number};var be=function(e){function t(e){var r;return _(this,t),A($(r=X(this,H(t).call(this,e))),"handleChangePage",function(){var e=N(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r.props.updatePaginationCallback({page:n});case 1:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}()),A($(r),"handleChangeRowsPerPage",function(){var e=N(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r.props.updatePaginationCallback({page:0,rowsPerPage:+t.target.value});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),r}return L(t,I.Component),V(t,[{key:"render",value:function(){var e=this.props,t=e.totalNumberOfEntities,r=e.rowsPerPage,n=e.page;return I.createElement(I.Fragment,null,I.createElement(k,{rowsPerPageOptions:[10,20,50],component:"div",count:t,rowsPerPage:r,page:n,backIconButtonProps:{"aria-label":"Previous Page"},nextIconButtonProps:{"aria-label":"Next Page"},onChangePage:this.handleChangePage,onChangeRowsPerPage:this.handleChangeRowsPerPage}))}}]),t}();be.propTypes={page:s.number,rowsPerPage:s.number,rowsPerPageOptions:s.array,totalNumberOfEntities:s.number,updatePaginationCallback:s.func},be.defaultProps={page:0,rowsPerPage:10,totalNumberOfEntities:10,rowsPerPageOptions:[10,20,50],updatePaginationCallback:function(){}};var ye=E.makeStyles({container:{margin:"5px",display:"flex",position:"relative",paddingTop:"30px"},field:{margin:"5px"}}),ge=function(e){var t=e.field,r=e.options,n=e.removeCallback,a=e.index,o=ye();return I.createElement("div",{className:"".concat(a,"-sort-pair")},I.createElement("div",null,I.createElement(F.Field,{name:"".concat(t,".fieldName"),type:"chosenSelect",component:Re,options:r,label:"Sort",className:o.field}),I.createElement(F.Field,{name:"".concat(t,".direction"),type:"chosenSelect",component:Re,options:[{label:"ASC",value:"ASC"},{label:"DESC",value:"DESC"}],label:"Direction",className:o.field}),I.createElement(x,{className:"".concat(a,"-sort-pair-clear-icon"),onClick:n})))};ge.propTypes={removeCallback:s.func,index:s.number,field:s.string,options:s.array};var ve=E.makeStyles({paper:{padding:"1em"}}),Pe=function(e){var t=ve();return I.createElement(C,{className:t.paper},e.children)},Ce=function(e){switch(e.type){case"min-max":return I.createElement(I.Fragment,null,I.createElement(F.Field,{type:"text",component:Re,name:"".concat(e.name,"_min"),key:"".concat(e.label,"_min"),label:"".concat(e.label," Min")},"".concat(e.label," Min")),I.createElement(F.Field,{type:"text",component:Re,name:"".concat(e.name,"_max"),key:"".concat(e.label,"_max"),label:"".concat(e.label," Max")},"".concat(e.label," Max")));default:return I.createElement(F.Field,{type:"text",component:Re,name:e.name,key:e.key,label:e.label},e.label)}};Ce.propTypes={name:s.string,label:s.string,type:s.string,key:s.number};var Ee=function(e){function t(e){var r;return _(this,t),A($(r=X(this,H(t).call(this,e))),"renderField",function(e){return I.createElement(Ce,{name:e.name,key:e.label,label:e.label,type:e.filter.type},e.label)}),A($(r),"renderBasicFilters",function(){return r.props.tableDefinition.filter(function(e){return e.hasOwnProperty("filter")&&e.filter.hasOwnProperty("type")&&e.filter.hasOwnProperty("basicFilter")}).map(r.renderField)}),A($(r),"renderAdvancedFilters",function(){if(r.state.isAdvanced){var e=r.props.tableDefinition.filter(function(e){return e.hasOwnProperty("sort")});return I.createElement("div",null,r.props.tableDefinition.filter(function(e){return e.hasOwnProperty("filter")&&e.filter.hasOwnProperty("type")&&!e.filter.hasOwnProperty("basicFilter")}).map(r.renderField),I.createElement(T,{variant:"h6"},"Sort"),I.createElement(F.FieldArray,{name:"sortPairs",availableFields:e,component:r.renderPairs}))}return null}),A($(r),"renderPairs",function(e){var t=e.fields,r=e.availableFields.map(function(e){return{value:e.name,label:e.label}});return I.createElement(I.Fragment,null,t.map(function(e,n){return I.createElement(ge,{key:n,field:e,options:r,removeCallback:function(){return t.remove(n)}})}),I.createElement("div",{className:"add-new-sort-pair"},I.createElement(S,{onClick:function(){return t.push()}})))}),A($(r),"renderChips",function(e){return r.state.isAdvanced?null:I.createElement(C,null,Object.keys(e).map(function(t){return"sortPairs"===t?e[t].map(function(e){return I.createElement(w,{key:e.fieldName,label:"".concat(e.fieldName.label,": ").concat(e.direction.label),onDelete:r.handleChipDeleteForSort(e),color:"secondary"})}):I.createElement(w,{key:t,label:"".concat(t,": ").concat(O.isObject(e[t])?Object.values(e[t]):e[t]),onDelete:r.handleChipDeleteForFilter(t),color:"primary"})}))}),A($(r),"onClickExpandHandler",function(e){e.preventDefault(),r.setState({isAdvanced:!r.state.isAdvanced})}),A($(r),"handleChipDeleteForSort",function(e){return function(){if(r.state.submittedData.hasOwnProperty("sortPairs")){var t=r.state.submittedData.sortPairs.indexOf(e),n=O.omit(r.state.submittedData,"sortPairs");n.sortPairs=r.state.submittedData.sortPairs.filter(function(t){return t!==e}),r.setState({submittedData:n},function(){r.props.onSubmit(r.state.submittedData)}),r.props.arrayRemoveElement("sortPairs",t)}}}),A($(r),"handleChipDeleteForFilter",function(e){return function(){if(r.state.submittedData.hasOwnProperty(e)){var t=O.omit(r.state.submittedData,e);r.props.changeFieldValue(e,""),r.setState({submittedData:t},function(){r.props.onSubmit(r.state.submittedData)})}}}),A($(r),"onSubmit",function(){var e=N(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.props.onSubmit(t);case 2:r.setState({submittedData:t});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),A($(r),"onCancel",function(){r.props.destroy("TableFilterForm"),r.setState({submittedData:{}}),r.props.onResetCallback&&r.props.onResetCallback()}),r.state={isAdvanced:!1,submittedData:{sortPairs:e.defaultSort}},r}return L(t,I.Component),V(t,[{key:"render",value:function(){var e=this.props.submitting,t=e?1:0;return I.createElement(Pe,null,I.createElement("form",{onSubmit:this.props.handleSubmit(this.onSubmit),autoComplete:"off"},this.renderBasicFilters(),this.renderAdvancedFilters(),I.createElement("div",null,I.createElement(h,{onClick:this.onClickExpandHandler},"Advanced Filters")),this.renderChips(this.state.submittedData),I.createElement(pe,{type:"submit",variant:"contained",color:"primary",is_submitting:t,disabled:!!e},"Filter"),I.createElement(h,{onClick:this.onCancel},"Cancel")))}}]),t}();Ee.propTypes=G({},F.propTypes,{onResetCallback:s.func,handleSubmit:s.func,onSubmit:s.func,tableDefinition:s.array,defaultSort:s.array});var Oe=F.reduxForm({form:"TableFilterForm"})(Ee),ke=r.withStyles(function(){return{addCircle:{display:"flex",alignItems:"center",justifyContent:"center"}}})(D.connect(function(e,t){return{initialValues:{sortPairs:t.defaultSort}}},function(e){return{changeFieldValue:function(t,r){e(F.change("TableFilterForm",t,r))},arrayRemoveElement:function(t,r){e(F.arrayRemove("TableFilterForm",t,r))}}})(Oe)),we=r.withStyles(function(e){return{head:{backgroundColor:e.palette.common.black,color:e.palette.common.white,padding:"0px 10px"},body:{padding:"0px 10px"}}})(g),Fe=function(e){function t(e){var r;return _(this,t),A($(r=X(this,H(t).call(this,e))),"invokeFetchCallback",function(){r.props.fetchCallback&&r.props.fetchCallback(r.state.filterOptions,r.state.paginationInfo)}),A($(r),"updatePagination",function(e){r.setState({paginationInfo:G({},r.state.paginationInfo,{},e)},r.invokeFetchCallback)}),A($(r),"applyFilter",function(e){r.setState({filterOptions:G({},e),paginationInfo:G({},r.state.paginationInfo,{page:0})},r.invokeFetchCallback)}),A($(r),"defaultSorts",function(){return r.tableDefinition.filter(function(e){return e.hasOwnProperty("sort")&&e.sort.hasOwnProperty("defaultSort")}).map(function(e){return{fieldName:{value:e.name,label:e.label},direction:{value:e.sort.defaultSort,label:e.sort.defaultSort}}})}),A($(r),"onReset",function(){r.setState({filterOptions:{},paginationInfo:G({},r.state.paginationInfo,{page:0,rowsPerPage:r.props.paginatorInfo.rowsPerPage})},r.invokeFetchCallback)}),n($(r)),r._initialize(e),r.state={filterOptions:{},paginationInfo:e.paginatorInfo},r}return L(t,I.Component),V(t,[{key:"shouldComponentUpdate",value:function(e,t,r){return this._initialize(e),!0}},{key:"_initialize",value:function(e){this.items=O.isArray(e.items)?e.items:Object.values(e.items),this.totalNumberOfEntities=e.totalNumberOfEntities||this.items.length,e.preprocessItemsCallback&&(this.items=e.preprocessItemsCallback(this.items)),this.tableDefinition=this._generateTableDefinition(e)}},{key:"_generateTableDefinition",value:function(e){return e.tableDefinition.length?e.tableDefinition:this.items.length?Object.keys(this.items[0]).map(function(e){return{label:e.charAt(0).toLocaleUpperCase()+e.slice(1),property:e}}):[]}},{key:"renderSectionHeader",value:function(){var e=this.props.sectionLabel;if(e)return I.createElement(he,{sectionLabel:e,colSpan:this.tableDefinition.length})}},{key:"renderHeader",value:function(){var e=this,t=this.tableDefinition.map(function(e){return{label:e.label}});return t.length?I.createElement(v,null,I.createElement(P,null,t.map(function(t,r){return e.renderHeaderCell(t,r)}))):null}},{key:"renderBody",value:function(){var e=this.props.autoPaginateItems,t=this.state.paginationInfo,r=t.page,n=t.rowsPerPage;return I.createElement(y,null,e?this.items.slice(r*n,(r+1)*n).map(this.renderRow):this.items.map(this.renderRow))}},{key:"renderHeaderCell",value:function(e,t){return I.createElement(we,M({key:t},e),e.label)}},{key:"getCellValue",value:function(e,t){return e.property?"string"==typeof e.property?t[e.property]:O.isArray(e.property)?e.property.reduce(function(e,t){return e&&e.hasOwnProperty(t)?e[t]:""},t):O.isFunction(e.property)?e.property(t):"":""}},{key:"renderCell",value:function(e,t,r){var n=this.getCellValue(t,e);return t.hasOwnProperty("render")?n=t.render(n,e):O.isBoolean(n)&&(n=n?"yes":"no"),I.createElement(we,{key:r},n)}},{key:"renderRow",value:function(e,t){var r=this,n=this.props.classes;return I.createElement(P,{className:n.row,key:t},this.tableDefinition.map(function(t,n){return r.renderCell(e,t,n)}))}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.reloading,a=e.paginator,o=e.filter;return I.createElement(C,{className:t.root},o&&I.createElement(ke,{onSubmit:this.applyFilter,tableDefinition:this.props.tableDefinition,defaultSort:this.defaultSorts(),onResetCallback:this.onReset}),I.createElement(b,{className:t.table},this.renderSectionHeader(),this.renderHeader(),this.renderBody()),n&&I.createElement(fe,null),n&&I.createElement(r.LinearProgress,null),a&&I.createElement(be,M({updatePaginationCallback:this.updatePagination},this.state.paginationInfo,{totalNumberOfEntities:this.totalNumberOfEntities})))}}]),t}();Fe.propTypes={items:s.oneOfType([s.object,s.array]),tableDefinition:s.array,preprocessItemsCallback:s.func,sectionLabel:s.string,reloading:s.bool,paginator:s.oneOfType([s.bool,s.object]),paginatorInfo:s.object,fetchCallback:s.func,filter:s.bool,totalNumberOfEntities:s.number,classes:s.object,autoPaginateItems:s.bool},Fe.defaultProps={items:{},tableDefinition:[],reloading:!1,paginator:!1,paginatorInfo:{page:0,rowsPerPage:50,rowsPerPageOptions:[10,20,50]},filter:!1,autoPaginateItems:!1};var xe=r.withStyles(function(e){return{root:{width:"100%",marginTop:e.spacing(3),overflowX:"auto",position:"relative"},row:{"&:nth-of-type(odd)":{backgroundColor:e.palette.background.default}}}})(Fe),Se=function(e){function n(e){var t;return _(this,n),A($(t=X(this,H(n).call(this,e))),"generateTableDefinition",function(){return t.props.tableDefinition.map(function(e){return O.isObject(e)?e:{label:e,property:e}}).concat([{label:"Actions",property:t._tableActions}])}),A($(t),"_tableActions",function(e){return I.createElement(r.IconButton,{"aria-label":"Delete",onClick:function(){return t._handleRemove(e)}},I.createElement(c.Delete,{style:{color:"red"}}))}),A($(t),"_handleRemove",function(e){var r=t.props,n=r.valueProperty,a=r.name,o=t.getFieldValue();o=o.filter(function(t){return t.value!==e[n]}),t.updateFieldValue(a,o)}),A($(t),"getOptions",function(e){var r=t.props,n=r.rawOptions;if(r.groupOptionsBy){var a=t.getSelectedGroup();return t.groupOptions(t.filterOptions(n,e,a))}return t.filterOptions(n,e).map(function(e){return t.processOption(e)})}),A($(t),"getFieldValue",function(){var e=t.props,r=e.getCurrentValue,n=e.name;if(t.refField.current){var a=t.refField.current.context._reduxForm.form;return(r(F.formValueSelector(a),n)||[]).slice(0)}return[]}),A($(t),"getSelectedGroup",function(){var e=t.props,r=e.getCurrentValue,n=e.name;if(t.refField.current){var a=t.refField.current.context._reduxForm.form,o=r(F.formValueSelector(a),"".concat(n,"_items_groups"));return o?o.value:null}return null}),t.refField=I.createRef(),t}return L(n,t.Component),V(n,[{key:"filterOptions",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.props,a=n.valueProperty,o=n.groupOptionsBy;return e.filter(function(e){return(!t||t&&t.indexOf(e[a])<0)&&(r&&e[o]===r||!r)})}},{key:"processOption",value:function(e){var t=this.props.valueProperty,r=O.isString(this.props.labelProperties)?[this.props.labelProperties]:this.props.labelProperties;return{value:e[t],label:r.map(function(t){return e.hasOwnProperty(t)?e[t]:""}).join(" ")}}},{key:"groupOptions",value:function(e){var t=this,r=this.props.groupOptionsBy,n=e.reduce(function(e,n){return n.hasOwnProperty(r)&&!e.hasOwnProperty(n[r])&&(e[n[r]]=[]),e[n[r]].push(t.processOption(n)),e},{});return Object.keys(n).map(function(e){return{label:e,options:n[e]}})}},{key:"getGroupsFieldOptions",value:function(){var e=this.props,t=e.rawOptions,r=e.groupOptionsBy;return Object.values(t.reduce(function(e,t){return t.hasOwnProperty(r)&&!e.hasOwnProperty(t[r])&&(e[t[r]]={value:t[r],label:t[r]}),e},{}))}},{key:"renderGroupedOptions",value:function(e){var t=this,n=this.props,a=n.label,o=n.name,i=n.groupOptionsBy;return I.createElement(I.Fragment,null,I.createElement(r.Grid,{item:!0,xs:2},I.createElement(F.Field,{name:"".concat(o,"_items_groups"),label:"".concat(i),component:Re,type:"chosenSelect",onChange:function(){t.updateFieldValue("".concat(o,"_items"),null),t.forceUpdate()},options:this.getGroupsFieldOptions()})),I.createElement(r.Grid,{item:!0,xs:7},I.createElement(F.Field,{ref:this.refField,name:"".concat(o,"_items"),label:a,component:Re,type:"chosenSelect",options:this.getOptions(e)})))}},{key:"renderOptions",value:function(e){var t=this.props,n=t.name,a=t.label;return I.createElement(r.Grid,{item:!0,xs:9},I.createElement(F.Field,{ref:this.refField,name:"".concat(n,"_items"),label:a,component:Re,type:"chosenSelect",options:this.getOptions(e)}))}},{key:"updateFieldValue",value:function(e,t){var r=this.props.changeFieldValue;this.refField.current&&r(this.refField.current.context._reduxForm.form,e,t)}},{key:"render",value:function(){var e=this,t=this.props,n=t.label,a=t.name,o=t.rawOptions,i=t.onChange,l=t.groupOptionsBy,u=t.valueProperty,s=this.getFieldValue(),p=s.map(function(e){return e.value}),d=o.filter(function(e){return p.indexOf(e[u])>=0});return I.createElement(I.Fragment,null,I.createElement(xe,{sectionLabel:n,items:d,tableDefinition:this.generateTableDefinition()}),I.createElement(r.Grid,{container:!0,spacing:1,direction:"row",alignItems:"flex-end",justify:"center"},l&&this.renderGroupedOptions(p),!l&&this.renderOptions(p),I.createElement(r.Grid,{item:!0,xs:3},I.createElement("div",{className:"actions"},I.createElement(r.Button,{variant:"outlined",onClick:function(){e.refField.current.value&&(s.push(e.refField.current.value),i(s),e.updateFieldValue("".concat(a,"_items"),null),e.updateFieldValue("".concat(a,"_items_groups"),null),e.forceUpdate())}},I.createElement(c.AddCircle,{fontSize:"small"}),"Add ".concat(n))))))}}]),n}();Se.propTypes={label:s.string.isRequired,tableDefinition:s.array.isRequired,labelProperties:s.oneOfType([s.array,s.string]).isRequired,changeFieldValue:s.func,getCurrentValue:s.func,rawOptions:s.array,groupOptionsBy:s.string,valueProperty:s.string},Se.defaultProps={rawOptions:[],valueProperty:"id"};var Te=D.connect(function(e,t){return{getCurrentValue:function(t,r){return t(e,r)}}},function(e,t){return{changeFieldValue:function(t,r,n){e(F.change(t,r,n))}}})(Se),De=r.makeStyles(function(e){return{formControl:{marginTop:e.spacing(3),width:"100%"},errorMessage:{marginBottom:e.spacing(1)}}}),je=function(e){var t=De(),n=e.error;return O.isArray(n)?n.map(function(e,n){return I.createElement(r.Typography,{className:t.errorMessage,key:n,paragraph:!0,color:"error"},e)}):O.isString(n)?I.createElement(r.Typography,{className:t.errorMessage,paragraph:!0,color:"error"},n):null},Ie=function(e){switch(e.type){case"select":return n=(t=e).input,a=t.label,t.type,o=t.options,i=t.meta,l=i.touched,u=i.error,I.createElement("div",null,I.createElement("label",{htmlFor:n.name},a),I.createElement("div",null,I.createElement("select",M({},n,{placeholder:a}),I.createElement("option",{key:"_none",value:"",disabled:!0,hidden:!0}),Object.entries(o).map(function(e){var t=J(e,2),r=t[0],n=t[1];return I.createElement("option",{key:r,value:r},n)})),l&&u&&I.createElement(je,{error:u})));case"chosenSelect":return function(e){var t=e.input,r=e.label,n=(e.type,e.loading),a=e.disabled,o=e.defaultValue,i=e.options,l=e.meta,u=l.touched,c=l.error,s=e.onMount,p=e.required,d=De();return I.createElement("div",{className:d.formControl},I.createElement(ce,{input:t,name:t.name,options:i,isMulti:!1,multi:!1,placeholder:r,label:r+(p?"*":""),error:!!c&&u,onMount:s,loading:n,disabled:a,value:t.value||o}),u&&c&&I.createElement(je,{error:c}))}(e);case"chosenMultiSelect":return function(e){var t=e.input,r=e.label,n=(e.type,e.loading),a=e.disabled,o=e.defaultValue,i=e.options,l=e.meta,u=l.touched,c=l.error,s=e.onMount,p=e.required,d=De();return I.createElement("div",{className:d.formControl},I.createElement("div",null,I.createElement(ce,{input:t,name:t.name,options:i,isMulti:!0,multi:!0,placeholder:r,label:r+(p?"*":""),error:!!c&&u,onMount:s,loading:n,disabled:a,value:t.value||o}),u&&c&&I.createElement(je,{error:c})))}(e);case"textarea":return function(e){var t=e.input,n=e.label,a=(e.type,e.meta),o=a.touched,i=a.error,l=e.required;return I.createElement("div",null,I.createElement(r.TextField,{defaultValue:t.value,autoFocus:!!t.autofocus,margin:"dense",multiline:!0,rows:2,rowsMax:20,id:t.id,label:n+(l?"*":""),onChange:function(e){return t.onBlur(e.target.value)},fullWidth:!0,name:t.name,error:!!i&&o}),o&&i&&I.createElement(je,{error:i}))}(e);case"checkbox":return function(e){var t=e.input,r=e.checked,n=e.label,a=(e.type,e.meta),o=a.touched,i=a.error;return I.createElement("div",null,I.createElement(K,{label:n,name:t.name,checked:t.value||r,onChange:t.onChange}),o&&i&&I.createElement(je,{error:i}))}(e);case"text":case"password":return function(e){var t=e.input,n=e.label,a=e.helperText,o=e.type,i=e.onChangeHandler,l=e.disabled,u=e.inputProps,c=e.meta,s=c.touched,p=c.error,d=e.required;return I.createElement("div",null,I.createElement(r.TextField,M({},t,{value:"object"===R(t.value)?t.value.label:t.value,autoFocus:!!t.autofocus,margin:"dense",id:t.id,label:n+(d?"*":""),type:o,fullWidth:!0,onChange:function(e){return i&&i(e),t.onBlur(e.target.value)},name:t.name,error:!!p&&s,helperText:a,disabled:l,InputProps:u})),s&&p&&I.createElement(je,{error:p}))}(e);case"datePicker":return function(e){var t=e.input,n=e.startDate,a=e.label,o=e.dateFormat,i=e.inputProps,l=e.meta,u=l.touched,c=l.error,s=De();return I.createElement("div",{className:s.formControl},I.createElement(j,M({},e,{customInput:I.createElement(r.TextField,{margin:"dense",fullWidth:!0,error:!!c&&u,label:a,InputProps:i}),error:!!c&&u,selected:t.value?t.value:n,onChange:function(e){return t.onChange(e)},dateFormat:o})),u&&c&&I.createElement(je,{error:c}))}(e);case"fieldsGroupWrapper":return function(e){var t=e.children,r=(e.input,e.label,e.type,e.meta),n=r.touched,a=r.error;return I.createElement("div",null,t,n&&a&&I.createElement(je,{error:a}))}(e);case"color":return function(e){var t=e.input,r=e.label,n=(e.type,e.meta),a=n.touched,o=n.error;return I.createElement("div",null,I.createElement(Y,{input:t,name:t.name,label:r}),a&&o&&I.createElement(je,{error:o}))}(e);case"multiValueSelect":return function(e){var t=e.input,r=e.label,n=e.tableDefinition,a=e.labelProperties,o=e.groupOptionsBy,i=e.rawOptions,l=e.meta;l.touched,l.error;return I.createElement("div",null,I.createElement(Te,{name:t.name,onChange:t.onChange,label:r,tableDefinition:n,labelProperties:a,rawOptions:i,groupOptionsBy:o}))}(e);default:return function(e){var t=e.input,r=e.label,n=e.type,a=e.meta,o=a.touched,i=a.error;return I.createElement("div",null,I.createElement("label",{htmlFor:t.name},r),I.createElement("div",null,I.createElement("input",M({},t,{placeholder:r,type:n})),o&&i&&I.createElement(je,{error:i})))}(e)}var t,n,a,o,i,l,u},Re=function(e){return I.createElement("div",{className:"form-item"},Ie(e))};e.FieldCheckbox=K,e.FieldColor=Y,e.FieldSelect=ce,e.LoadingBox=fe,e.MultiValueSelect=Te,e.RenderErrors=je,e.SubmitButton=pe,e.Table=xe,e.renderField=Re,Object.defineProperty(e,"__esModule",{value:!0})});
