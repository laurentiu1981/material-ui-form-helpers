!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("@material-ui/core"),require("class-autobind"),require("react-color"),require("clsx"),require("react-select"),require("@material-ui/core/styles"),require("@material-ui/core/MenuItem"),require("@material-ui/icons"),require("prop-types"),require("@material-ui/core/InputAdornment"),require("@material-ui/core/SvgIcon"),require("lodash/isBoolean"),require("@material-ui/core/CircularProgress"),require("@material-ui/styles/index"),require("@material-ui/core/Button"),require("@material-ui/core/Table"),require("@material-ui/core/TableBody"),require("@material-ui/core/TableCell"),require("@material-ui/core/TableHead"),require("@material-ui/core/TableRow"),require("@material-ui/core/Paper"),require("@material-ui/styles"),require("lodash"),require("@material-ui/core/TablePagination"),require("@material-ui/core/Chip"),require("redux-form"),require("@material-ui/icons/Clear"),require("@material-ui/icons/AddCircle"),require("@material-ui/core/Typography/Typography"),require("react-redux"),require("react-datepicker"),require("react-datepicker/dist/react-datepicker.css")):"function"==typeof define&&define.amd?define(["exports","react","@material-ui/core","class-autobind","react-color","clsx","react-select","@material-ui/core/styles","@material-ui/core/MenuItem","@material-ui/icons","prop-types","@material-ui/core/InputAdornment","@material-ui/core/SvgIcon","lodash/isBoolean","@material-ui/core/CircularProgress","@material-ui/styles/index","@material-ui/core/Button","@material-ui/core/Table","@material-ui/core/TableBody","@material-ui/core/TableCell","@material-ui/core/TableHead","@material-ui/core/TableRow","@material-ui/core/Paper","@material-ui/styles","lodash","@material-ui/core/TablePagination","@material-ui/core/Chip","redux-form","@material-ui/icons/Clear","@material-ui/icons/AddCircle","@material-ui/core/Typography/Typography","react-redux","react-datepicker","react-datepicker/dist/react-datepicker.css"],t):t((e=e||self)["material-ui-form-helpers"]={},e.React,e.core,e.autobind,e.reactColor,e.clsx,e.Select,e.styles$3,e.MenuItem,e.icons,e.PropTypes,e.InputAdornment,e.AccountCircle,e.isBoolean,e.CircularProgress,e.index,e.Button,e.Table$1,e.TableBody,e.TableCell,e.TableHead,e.TableRow,e.Paper,e.styles$4,e._$1,e.TablePagination,e.Chip,e.reduxForm,e.ClearIcon,e.AddCircleIcon,e.Typography,e.reactRedux,e.DatePicker)}(this,function(e,t,r,n,a,o,i,l,u,c,s,p,d,f,m,h,y,b,g,v,P,C,E,O,w,k,x,F,S,T,D,j,q){"use strict";var R="default"in t?t.default:t;function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(e,t,r,n,a,o,i){try{var l=e[o](i),u=l.value}catch(e){return void r(e)}l.done?t(u):Promise.resolve(u).then(n,a)}function B(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function i(e){N(o,n,a,i,l,"next",e)}function l(e){N(o,n,a,i,l,"throw",e)}i(void 0)})}}function V(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function M(e,t,r){return t&&A(e.prototype,t),r&&A(e,r),e}function G(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L(){return(L=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?H(r,!0).forEach(function(t){G(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function W(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$(e,t)}function U(e){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $(e,t){return($=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function X(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function J(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function K(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?J(e):t}function Q(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}n=n&&n.hasOwnProperty("default")?n.default:n,o=o&&o.hasOwnProperty("default")?o.default:o,i=i&&i.hasOwnProperty("default")?i.default:i,u=u&&u.hasOwnProperty("default")?u.default:u,s=s&&s.hasOwnProperty("default")?s.default:s,p=p&&p.hasOwnProperty("default")?p.default:p,d=d&&d.hasOwnProperty("default")?d.default:d,f=f&&f.hasOwnProperty("default")?f.default:f,m=m&&m.hasOwnProperty("default")?m.default:m,y=y&&y.hasOwnProperty("default")?y.default:y,b=b&&b.hasOwnProperty("default")?b.default:b,g=g&&g.hasOwnProperty("default")?g.default:g,v=v&&v.hasOwnProperty("default")?v.default:v,P=P&&P.hasOwnProperty("default")?P.default:P,C=C&&C.hasOwnProperty("default")?C.default:C,E=E&&E.hasOwnProperty("default")?E.default:E,w=w&&w.hasOwnProperty("default")?w.default:w,k=k&&k.hasOwnProperty("default")?k.default:k,x=x&&x.hasOwnProperty("default")?x.default:x,S=S&&S.hasOwnProperty("default")?S.default:S,T=T&&T.hasOwnProperty("default")?T.default:T,D=D&&D.hasOwnProperty("default")?D.default:D,q=q&&q.hasOwnProperty("default")?q.default:q;var Y=function(e){function t(e){var r;return V(this,t),r=K(this,U(t).call(this,e)),n(J(r)),r.state={checked:!!e.checked},r}return W(t,R.Component),M(t,[{key:"handleChange",value:function(e){this.props.onChange(e),this.setState({checked:!this.state.checked})}},{key:"render",value:function(){var e=this.props,t=e.label,n=e.name;return R.createElement(r.FormControlLabel,{control:R.createElement(r.Checkbox,{checked:this.state.checked,color:"default",onChange:this.handleChange,value:n}),label:t})}}]),t}(),Z=function(e){function t(e){var r;return V(this,t),G(J(r=K(this,U(t).call(this,e))),"handleColorChangeComplete",function(e){r.props.input.onBlur(e.hex),r.toggleColorPicker()}),G(J(r),"handleInputChange",function(e){r.props.input.onBlur(e.target.value)}),n(J(r)),r.state={openColorPicker:!1},r}return W(t,R.Component),M(t,[{key:"toggleColorPicker",value:function(){this.setState({openColorPicker:!this.state.openColorPicker})}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.input,o=e.label,i=e.placeholder,l=this.state.openColorPicker;return R.createElement("div",{className:t.colorField},R.createElement(r.TextField,{margin:"dense",name:n.name,id:n.id,value:n.value,label:o,type:"text",placeholder:i,onChange:this.handleInputChange}),R.createElement("div",{className:t.colorDiv,style:{backgroundColor:n.value},onClick:this.toggleColorPicker}),l&&R.createElement(a.SketchPicker,{className:t.colorPicker,color:n.value,onChangeComplete:this.handleColorChangeComplete}))}}]),t}(),ee=r.withStyles(function(e){return{title:{width:"500px",backgroundColor:"#edeeef"},colorField:{display:"flex",flexDirection:"row"},colorDiv:{marginTop:"15px",marginBottom:"4px",width:"38px",height:"38px",marginLeft:"10px",border:"1px solid #edeeef",display:"flex-inline"},colorPicker:{position:"absolute",left:"155px",top:"25px",zIndex:1},colorWrapper:{display:"flex",alignItems:"center"},notes:{width:"100%"}}})(Z),te=r.makeStyles(function(e){return{root:{flexGrow:1,height:250},input:{display:"flex",padding:0,height:"auto"},valueContainer:{display:"flex",flexWrap:"wrap",flex:1,alignItems:"center",overflow:"hidden"},chip:{margin:e.spacing(.5,.25)},chipFocused:{backgroundColor:l.emphasize("light"===e.palette.type?e.palette.grey[300]:e.palette.grey[700],.08)},noOptionsMessage:{padding:e.spacing(1,2)},singleValue:{fontSize:16},placeholder:{position:"absolute",left:2,bottom:6,fontSize:16},paper:{position:"absolute",zIndex:1,marginTop:e.spacing(1),left:0,right:0},divider:{height:e.spacing(2)}}});function re(e){return R.createElement(r.Typography,L({color:"textSecondary",className:e.selectProps.classes.noOptionsMessage},e.innerProps),e.children)}function ne(e){var t=e.inputRef,r=X(e,["inputRef"]);return R.createElement("div",L({ref:t},r))}function ae(e){var t=e.children,n=e.innerProps,a=e.innerRef,o=e.selectProps,i=o.classes,l=o.TextFieldProps;return R.createElement(r.TextField,L({fullWidth:!0,InputProps:{inputComponent:ne,inputProps:z({className:i.input,ref:a,children:t},n)}},l))}function oe(e){return R.createElement(r.Typography,L({color:"textSecondary",className:e.selectProps.classes.placeholder},e.innerProps),e.children)}function ie(e){return R.createElement(r.Typography,L({className:e.selectProps.classes.singleValue},e.innerProps),e.children)}function le(e){return R.createElement("div",{className:e.selectProps.classes.valueContainer},e.children)}function ue(e){return R.createElement(r.Chip,{tabIndex:-1,label:e.children,className:o(e.selectProps.classes.chip,G({},e.selectProps.classes.chipFocused,e.isFocused)),onDelete:e.removeProps.onClick,deleteIcon:R.createElement(c.Cancel,e.removeProps)})}function ce(e){return R.createElement(r.Paper,L({square:!0,className:e.selectProps.classes.paper},e.innerProps),e.children)}re.propTypes={children:s.node,innerProps:s.object,selectProps:s.object.isRequired},ne.propTypes={inputRef:s.oneOfType([s.func,s.object])},ae.propTypes={children:s.node,innerProps:s.object,innerRef:s.oneOfType([s.func,s.object]),selectProps:s.object.isRequired},s.node,s.object,s.oneOfType([s.func,s.object]),s.bool,s.bool,oe.propTypes={children:s.node,innerProps:s.object,selectProps:s.object.isRequired},ie.propTypes={children:s.node,innerProps:s.object,selectProps:s.object.isRequired},le.propTypes={children:s.node,selectProps:s.object.isRequired},ue.propTypes={children:s.node,isFocused:s.bool,removeProps:s.object.isRequired,selectProps:s.object.isRequired},ce.propTypes={children:s.node,innerProps:s.object,selectProps:s.object};var se={Control:ae,Menu:ce,MultiValue:ue,NoOptionsMessage:re,Placeholder:oe,SingleValue:ie,ValueContainer:le};function pe(e){var r=te(),n=l.useTheme(),a=Q(R.useState(null),2),o=(a[0],a[1]),u=Q(R.useState(null),2),c=(u[0],u[1]),s=Q(R.useState(null),2),m=s[0],h=s[1];t.useEffect(function(){e.onMount&&(h(!0),e.onMount().then(function(){h(!1)}))},[]),t.useEffect(function(){e.hasOwnProperty("loading")&&f(e.loading)&&h(e.loading)});var y={input:function(e){return z({},e,{color:n.palette.text.primary,"& input":{font:"inherit"}})}},b=e.id?"react-select-".concat(e.id):"react-select-".concat(e.name),g=e.defaultValue?{value:e.defaultValue,label:e.defaultValue}:"";return R.createElement(i,L({},e,{value:e.input.value||g,isDisabled:e.disabled,classes:r,styles:y,inputId:b,isLoading:m,TextFieldProps:{error:e.error,label:e.label,InputLabelProps:{htmlFor:b,shrink:!0,error:e.error},placeholder:e.placeholder,disabled:e.disabled},InputProps:{startAdornment:R.createElement(p,{position:"start"},R.createElement(d,null))},options:e.options||[],components:se,onChange:e.isMulti?function(t){c(t),e.input.onChange(t)}:function(t){o(t),e.input.onChange(t)},onBlur:function(){return e.input.onBlur(e.input.value)}}))}var de=h.makeStyles({progress:{marginRight:"5px"}}),fe=function(e){var t=de();return R.createElement(y,e,e.is_submitting?R.createElement(m,{size:20,className:t.progress}):null,e.children)};fe.propTypes={is_submitting:s.number};var me=O.makeStyles({root:{position:"absolute",width:"100%",height:"100%",top:0,left:0,display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden"},overlay:{position:"absolute",opacity:.3,backgroundColor:"#CCCCCC",width:"100%",height:"100%"}}),he=function(){var e=me();return R.createElement(R.Fragment,null,R.createElement("div",{className:e.root},R.createElement("div",{className:e.overlay}),R.createElement(r.CircularProgress,null)))},ye=O.makeStyles({root:{fontSize:"16px",fontWeight:600}}),be=function(e){var t=ye();return R.createElement(P,null,R.createElement(C,null,R.createElement(v,{colSpan:e.colSpan,className:t.root},e.sectionLabel)))};be.defaultProps={colspan:2},be.propTypes={sectionLabel:s.string.isRequired,colSpan:s.number};var ge=function(e){function t(e){var r;return V(this,t),G(J(r=K(this,U(t).call(this,e))),"handleChangePage",function(){var e=B(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r.props.updatePaginationCallback({page:n});case 1:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}()),G(J(r),"handleChangeRowsPerPage",function(){var e=B(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r.props.updatePaginationCallback({page:0,rowsPerPage:+t.target.value});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),r}return W(t,R.Component),M(t,[{key:"render",value:function(){var e=this.props,t=e.totalNumberOfEntities,r=e.rowsPerPage,n=e.page;return R.createElement(R.Fragment,null,R.createElement(k,{rowsPerPageOptions:[10,20,50],component:"div",count:t,rowsPerPage:r,page:n,backIconButtonProps:{"aria-label":"Previous Page"},nextIconButtonProps:{"aria-label":"Next Page"},onChangePage:this.handleChangePage,onChangeRowsPerPage:this.handleChangeRowsPerPage}))}}]),t}();ge.propTypes={page:s.number,rowsPerPage:s.number,totalNumberOfEntities:s.number,updatePaginationCallback:s.func},ge.defaultProps={page:0,rowsPerPage:10,totalNumberOfEntities:10,updatePaginationCallback:function(){}};var ve=O.makeStyles({container:{margin:"5px",display:"flex",position:"relative",paddingTop:"30px"},field:{margin:"5px"}}),Pe=function(e){var t=e.field,r=(e.defaultValue,e.options),n=e.removeCallback,a=e.index,o=ve();return R.createElement("div",{className:"".concat(a,"-sort-pair")},R.createElement("div",null,R.createElement(F.Field,{name:"".concat(t,".fieldName"),type:"chosenSelect",component:Ie,options:r,label:"Sort",className:o.field}),R.createElement(F.Field,{name:"".concat(t,".direction"),type:"chosenSelect",component:Ie,options:[{label:"ASC",key:"ASC"},{label:"DESC",key:"DESC"}],label:"Direction",className:o.field}),R.createElement(S,{className:"".concat(a,"-sort-pair-clear-icon"),onClick:n})))},Ce=O.makeStyles({paper:{padding:"1em"}}),Ee=function(e){var t=Ce();return R.createElement(E,{className:t.paper},e.children)},Oe=function(e){switch(e.type){case"min-max":return R.createElement(R.Fragment,null,R.createElement(F.Field,{type:"text",component:Ie,name:"".concat(e.name,"_min"),key:"".concat(e.label,"_min"),label:"".concat(e.label," Min")},"".concat(e.label," Min")),R.createElement(F.Field,{type:"text",component:Ie,name:"".concat(e.name,"_max"),key:"".concat(e.label,"_max"),label:"".concat(e.label," Max")},"".concat(e.label," Max")));default:return R.createElement(F.Field,{type:"text",component:Ie,name:e.name,key:e.key,label:e.label},e.label)}},we=function(e){function t(e){var r;return V(this,t),G(J(r=K(this,U(t).call(this,e))),"renderField",function(e){return R.createElement(Oe,{name:e.name,key:e.label,label:e.label,type:e.filter.type},e.label)}),G(J(r),"renderBasicFilters",function(){return r.props.tableDefinition.filter(function(e){return e.hasOwnProperty("filter")&&e.filter.hasOwnProperty("type")&&e.filter.hasOwnProperty("basicFilter")}).map(r.renderField)}),G(J(r),"renderAdvancedFilters",function(){if(r.state.isAdvanced){var e=r.props.tableDefinition.filter(function(e){return e.hasOwnProperty("sort")&&e.filter.hasOwnProperty("type")});return R.createElement("div",null,r.props.tableDefinition.filter(function(e){return e.hasOwnProperty("filter")&&e.filter.hasOwnProperty("type")&&!e.filter.hasOwnProperty("basicFilter")}).map(r.renderField),R.createElement(D,{variant:"h6"},"Sort"),R.createElement(F.FieldArray,{name:"sortPairs",availableFields:e,component:r.renderPairs}))}return null}),G(J(r),"renderPairs",function(e){var t=e.fields,r=e.availableFields.map(function(e){return{value:e.name,label:e.label}});return R.createElement(R.Fragment,null,t.map(function(e,n){return R.createElement(Pe,{key:n,field:e,options:r,removeCallback:function(){return t.remove(n)}})}),R.createElement("div",{className:"add-new-sort-pair"},R.createElement(T,{onClick:function(){return t.push()}})))}),G(J(r),"renderChips",function(e){return r.state.isAdvanced?null:R.createElement(E,null,Object.keys(e).map(function(t){return"sortPairs"===t?e[t].map(function(e){return R.createElement(x,{key:e.fieldName,label:"".concat(e.fieldName.label,": ").concat(e.direction.label),onDelete:r.handleChipDeleteForSort(e),color:"secondary"})}):R.createElement(x,{key:t,label:"".concat(t,": ").concat(w.isObject(e[t])?Object.values(e[t]):e[t]),onDelete:r.handleChipDeleteForFilter(t),color:"primary"})}))}),G(J(r),"onClickExpandHandler",function(e){e.preventDefault(),r.setState({isAdvanced:!r.state.isAdvanced})}),G(J(r),"handleChipDeleteForSort",function(e){return function(){if(r.state.submittedData.hasOwnProperty("sortPairs")){var t=r.state.submittedData.sortPairs.indexOf(e),n=w.omit(r.state.submittedData,"sortPairs");n.sortPairs=r.state.submittedData.sortPairs.filter(function(t){return t!==e}),r.setState({submittedData:n},function(){r.props.onSubmit(r.state.submittedData)}),r.props.arrayRemoveElement("sortPairs",t)}}}),G(J(r),"handleChipDeleteForFilter",function(e){return function(){if(r.state.submittedData.hasOwnProperty(e)){var t=w.omit(r.state.submittedData,e);r.setState({submittedData:t},function(){r.props.onSubmit(r.state.submittedData)})}}}),G(J(r),"onSubmit",function(){var e=B(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.props.onSubmit(t);case 2:r.setState({submittedData:t});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),G(J(r),"onCancel",function(){r.props.destroy("TableFilterForm"),r.setState({submittedData:{}}),r.props.onResetCallback()}),r.state={isAdvanced:!1,submittedData:{sortPairs:e.defaultSort}},r}return W(t,R.Component),M(t,[{key:"render",value:function(){var e=this.props,t=e.submitting,r=(e.classes,e.fields,e.submittedData,t?1:0);return R.createElement(Ee,null,R.createElement("form",{onSubmit:this.props.handleSubmit(this.onSubmit),autoComplete:"off"},this.renderBasicFilters(),this.renderAdvancedFilters(),R.createElement("div",null,R.createElement(y,{onClick:this.onClickExpandHandler},"Advanced Filters")),this.renderChips(this.state.submittedData),R.createElement(fe,{type:"submit",variant:"contained",color:"primary",is_submitting:r,disabled:!!t},"Filter"),R.createElement(y,{onClick:this.onCancel},"Cancel")))}}]),t}();we.propTypes={onResetCallback:s.func},we=F.reduxForm({form:"TableFilterForm"})(we);var ke=r.withStyles(function(e){return{addCircle:{display:"flex",alignItems:"center",justifyContent:"center"}}})(j.connect(function(e,t){return{initialValues:{sortPairs:t.defaultSort}}},function(e){return{changeFieldValue:function(t,r){e(F.change("TableFilterForm",t,r))},arrayRemoveElement:function(t,r){e(F.arrayRemove("TableFilterForm",t,r))}}})(we)),xe=r.withStyles(function(e){return{head:{backgroundColor:e.palette.common.black,color:e.palette.common.white,padding:"0px 10px"},body:{padding:"0px 10px"}}})(v),Fe=function(e){function t(e){var r;return V(this,t),G(J(r=K(this,U(t).call(this,e))),"updatePagination",function(e){r.setState({paginationInfo:z({},r.state.paginationInfo,{},e)},function(){r.props.fetchCallback(r.state.filterOptions,r.state.paginationInfo)})}),G(J(r),"applyFilter",function(e){r.setState({filterOptions:z({},r.state.filterOptions,{},e)},function(){r.props.fetchCallback(r.state.filterOptions,r.state.paginationInfo)})}),G(J(r),"defaultSorts",function(){return r.tableDefinition.filter(function(e){return e.hasOwnProperty("sort")&&e.sort.hasOwnProperty("defaultSort")}).map(function(e){return{fieldName:{value:e.name,label:e.label},direction:{value:e.sort.defaultSort,label:e.sort.defaultSort}}})}),G(J(r),"onReset",function(){r.setState({filterOptions:{},paginationInfo:z({},r.state.paginationInfo,{page:0,rowsPerPage:r.props.paginatorInfo.rowsPerPage})},function(){r.props.fetchCallback({},{page:0,rowsPerPage:r.props.paginatorInfo.rowsPerPage})})}),n(J(r)),r._initialize(e),r.state={filterOptions:{},paginationInfo:{}},r}return W(t,R.Component),M(t,[{key:"shouldComponentUpdate",value:function(e,t,r){return this._initialize(e),!0}},{key:"_initialize",value:function(e){this.items=w.isArray(e.items)?e.items:Object.values(e.items),this.tableDefinition=this._generateTableDefinition(e)}},{key:"_generateTableDefinition",value:function(e){return e.tableDefinition.length?e.tableDefinition:this.items.length?Object.keys(this.items[0]).map(function(e){return{label:e.charAt(0).toLocaleUpperCase()+e.slice(1),property:e}}):[]}},{key:"renderSectionHeader",value:function(){var e=this.props.sectionLabel;if(e)return R.createElement(be,{sectionLabel:e,colSpan:this.tableDefinition.length})}},{key:"renderHeader",value:function(){var e=this,t=this.tableDefinition.map(function(e){return{label:e.label}});return t.length?R.createElement(P,null,R.createElement(C,null,t.map(function(t,r){return e.renderHeaderCell(t,r)}))):null}},{key:"renderBody",value:function(){var e=this;return R.createElement(g,null,this.items.map(function(t,r){return e.renderRow(t,r)}))}},{key:"renderHeaderCell",value:function(e,t){return R.createElement(xe,L({key:t},e),e.label)}},{key:"getCellValue",value:function(e,t){return e.property?"string"==typeof e.property?t[e.property]:w.isArray(e.property)?e.property.reduce(function(e,t){return e&&e.hasOwnProperty(t)?e[t]:""},t):w.isFunction(e.property)?e.property(t):"":""}},{key:"renderCell",value:function(e,t,r){var n=this.getCellValue(t,e);return t.hasOwnProperty("render")?n=t.render(n,e):w.isBoolean(n)&&(n=n?"yes":"no"),R.createElement(xe,{key:r},n)}},{key:"renderRow",value:function(e,t){var r=this,n=this.props.classes;return R.createElement(C,{className:n.row,key:t},this.tableDefinition.map(function(t,n){return r.renderCell(e,t,n)}))}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.reloading,a=e.paginator,o=e.filter;return R.createElement(E,{className:t.root},o&&R.createElement(ke,{onSubmit:this.applyFilter,tableDefinition:this.props.tableDefinition,defaultSort:this.defaultSorts(),onResetCallback:this.onReset}),R.createElement(b,{className:t.table},this.renderSectionHeader(),this.renderHeader(),this.renderBody()),n&&R.createElement(he,null),n&&R.createElement(r.LinearProgress,null),a&&R.createElement(ge,this.state.paginationInfo))}}]),t}();Fe.propTypes={items:s.oneOfType([s.object,s.array]),tableDefinition:s.array,sectionLabel:s.string,reloading:s.bool,paginator:s.oneOfType([s.bool,s.object]),fetchCallback:s.func,filter:s.bool},Fe.defaultProps={items:{},tableDefinition:[],reloading:!1,paginator:!1,filter:!1};var Se=r.withStyles(function(e){return{root:{width:"100%",marginTop:e.spacing(3),overflowX:"auto",position:"relative"},row:{"&:nth-of-type(odd)":{backgroundColor:e.palette.background.default}}}})(Fe),Te=function(e){function n(e){var t;return V(this,n),G(J(t=K(this,U(n).call(this,e))),"generateTableDefinition",function(){return t.props.tableDefinition.map(function(e){return _.isObject(e)?e:{label:e,property:e}}).concat([{label:"Actions",property:t._tableActions}])}),G(J(t),"_tableActions",function(e){return R.createElement(r.IconButton,{"aria-label":"Delete",onClick:function(){return t._handleRemove(e)}},R.createElement(c.Delete,{style:{color:"red"}}))}),G(J(t),"_handleRemove",function(e){var r=t.props,n=r.valueProperty,a=r.name,o=t.getFieldValue();o=o.filter(function(t){return t.value!==e[n]}),t.updateFieldValue(a,o)}),G(J(t),"getOptions",function(e){var r=t.props,n=r.rawOptions;if(r.groupOptionsBy){var a=t.getSelectedGroup();return t.groupOptions(t.filterOptions(n,e,a))}return t.filterOptions(n,e).map(function(e){return t.processOption(e)})}),G(J(t),"getFieldValue",function(){var e=t.props,r=e.getCurrentValue,n=e.name;if(t.refField.current){var a=t.refField.current.context._reduxForm.form;return(r(F.formValueSelector(a),n)||[]).slice(0)}return[]}),G(J(t),"getSelectedGroup",function(){var e=t.props,r=e.getCurrentValue,n=e.name;if(t.refField.current){var a=t.refField.current.context._reduxForm.form,o=r(F.formValueSelector(a),"".concat(n,"_items_groups"));return o?o.value:null}return null}),t.refField=R.createRef(),t}return W(n,t.Component),M(n,[{key:"filterOptions",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.props,a=n.valueProperty,o=n.groupOptionsBy;return e.filter(function(e){return(!t||t&&t.indexOf(e[a])<0)&&(r&&e[o]===r||!r)})}},{key:"processOption",value:function(e){var t=this.props.valueProperty,r=_.isString(this.props.labelProperties)?[this.props.labelProperties]:this.props.labelProperties;return{value:e[t],label:r.map(function(t){return e.hasOwnProperty(t)?e[t]:""}).join(" ")}}},{key:"groupOptions",value:function(e){var t=this,r=this.props.groupOptionsBy,n=e.reduce(function(e,n){return n.hasOwnProperty(r)&&!e.hasOwnProperty(n[r])&&(e[n[r]]=[]),e[n[r]].push(t.processOption(n)),e},{});return Object.keys(n).map(function(e){return{label:e,options:n[e]}})}},{key:"getGroupsFieldOptions",value:function(){var e=this.props,t=e.rawOptions,r=e.groupOptionsBy;return Object.values(t.reduce(function(e,t){return t.hasOwnProperty(r)&&!e.hasOwnProperty(t[r])&&(e[t[r]]={value:t[r],label:t[r]}),e},{}))}},{key:"renderGroupedOptions",value:function(e){var t=this,n=this.props,a=n.label,o=n.name,i=n.groupOptionsBy;return R.createElement(R.Fragment,null,R.createElement(r.Grid,{item:!0,xs:2},R.createElement(F.Field,{name:"".concat(o,"_items_groups"),label:"".concat(i),component:Ie,type:"chosenSelect",onChange:function(){t.updateFieldValue("".concat(o,"_items"),null),t.forceUpdate()},options:this.getGroupsFieldOptions()})),R.createElement(r.Grid,{item:!0,xs:7},R.createElement(F.Field,{ref:this.refField,name:"".concat(o,"_items"),label:a,component:Ie,type:"chosenSelect",options:this.getOptions(e)})))}},{key:"renderOptions",value:function(e){var t=this.props,n=t.name,a=t.label;return R.createElement(r.Grid,{item:!0,xs:9},R.createElement(F.Field,{ref:this.refField,name:"".concat(n,"_items"),label:a,component:Ie,type:"chosenSelect",options:this.getOptions(e)}))}},{key:"updateFieldValue",value:function(e,t){var r=this.props.changeFieldValue;this.refField.current&&r(this.refField.current.context._reduxForm.form,e,t)}},{key:"render",value:function(){var e=this,t=this.props,n=t.label,a=t.name,o=t.rawOptions,i=t.onChange,l=t.groupOptionsBy,u=t.valueProperty,s=this.getFieldValue(),p=s.map(function(e){return e.value}),d=o.filter(function(e){return p.indexOf(e[u])>=0});return R.createElement(R.Fragment,null,R.createElement(Se,{sectionLabel:n,items:d,tableDefinition:this.generateTableDefinition()}),R.createElement(r.Grid,{container:!0,spacing:1,direction:"row",alignItems:"flex-end",justify:"center"},l&&this.renderGroupedOptions(p),!l&&this.renderOptions(p),R.createElement(r.Grid,{item:!0,xs:3},R.createElement("div",{className:"actions"},R.createElement(r.Button,{variant:"outlined",onClick:function(){e.refField.current.value&&(s.push(e.refField.current.value),i(s),e.updateFieldValue("".concat(a,"_items"),null),e.updateFieldValue("".concat(a,"_items_groups"),null),e.forceUpdate())}},R.createElement(c.AddCircle,{fontSize:"small"}),"Add ".concat(n))))))}}]),n}();Te.propTypes={label:s.string.isRequired,tableDefinition:s.array.isRequired,labelProperties:s.oneOfType([s.array,s.string]).isRequired,changeFieldValue:s.func,getCurrentValue:s.func,rawOptions:s.array,groupOptionsBy:s.string,valueProperty:s.string},Te.defaultProps={rawOptions:[],valueProperty:"id"};var De=j.connect(function(e,t){return{getCurrentValue:function(t,r){return t(e,r)}}},function(e,t){return{changeFieldValue:function(t,r,n){e(F.change(t,r,n))}}})(Te),je=r.makeStyles(function(e){return{formControl:{marginTop:e.spacing(3),width:"100%"},errorMessage:{marginBottom:e.spacing(1)}}}),qe=function(e){var t=je(),n=e.error;return w.isArray(n)?n.map(function(e,n){return R.createElement(r.Typography,{className:t.errorMessage,key:n,paragraph:!0,color:"error"},e)}):w.isString(n)?R.createElement(r.Typography,{className:t.errorMessage,paragraph:!0,color:"error"},n):null},Re=function(e){switch(e.type){case"select":return n=(t=e).input,a=t.label,t.type,o=t.options,i=t.meta,l=i.touched,u=i.error,R.createElement("div",null,R.createElement("label",{htmlFor:n.name},a),R.createElement("div",null,R.createElement("select",L({},n,{placeholder:a}),R.createElement("option",{key:"_none",value:"",disabled:!0,hidden:!0}),Object.entries(o).map(function(e){var t=Q(e,2),r=t[0],n=t[1];return R.createElement("option",{key:r,value:r},n)})),l&&u&&R.createElement(qe,{error:u})));case"chosenSelect":return function(e){var t=e.input,r=e.label,n=(e.type,e.loading),a=e.disabled,o=e.defaultValue,i=e.options,l=e.meta,u=l.touched,c=l.error,s=e.onMount,p=e.required,d=je();return R.createElement("div",{className:d.formControl},R.createElement(pe,{input:t,name:t.name,options:i,isMulti:!1,multi:!1,placeholder:r,label:r+(p?"*":""),error:!!c&&u,onMount:s,loading:n,disabled:a,value:t.value||o}),u&&c&&R.createElement(qe,{error:c}))}(e);case"chosenMultiSelect":return function(e){var t=e.input,r=e.label,n=(e.type,e.loading),a=e.disabled,o=e.defaultValue,i=e.options,l=e.meta,u=l.touched,c=l.error,s=e.onMount,p=e.required,d=je();return R.createElement("div",{className:d.formControl},R.createElement("div",null,R.createElement(pe,{input:t,name:t.name,options:i,isMulti:!0,multi:!0,placeholder:r,label:r+(p?"*":""),error:!!c&&u,onMount:s,loading:n,disabled:a,value:t.value||o}),u&&c&&R.createElement(qe,{error:c})))}(e);case"textarea":return function(e){var t=e.input,n=e.label,a=(e.type,e.meta),o=a.touched,i=a.error,l=e.required;return R.createElement("div",null,R.createElement(r.TextField,{defaultValue:t.value,autoFocus:!!t.autofocus,margin:"dense",multiline:!0,rows:2,rowsMax:20,id:t.id,label:n+(l?"*":""),onChange:function(e){return t.onBlur(e.target.value)},fullWidth:!0,name:t.name,error:!!i&&o}),o&&i&&R.createElement(qe,{error:i}))}(e);case"checkbox":return function(e){var t=e.input,r=e.checked,n=e.label,a=(e.type,e.meta),o=a.touched,i=a.error;return R.createElement("div",null,R.createElement(Y,{label:n,name:t.name,checked:t.value||r,onChange:t.onChange}),o&&i&&R.createElement(qe,{error:i}))}(e);case"text":case"password":return function(e){var t=e.input,n=e.label,a=e.helperText,o=e.type,i=e.onChangeHandler,l=e.disabled,u=e.inputProps,c=e.meta,s=c.touched,p=c.error,d=e.required;return R.createElement("div",null,R.createElement(r.TextField,L({},t,{value:"object"===I(t.value)?t.value.label:t.value,autoFocus:!!t.autofocus,margin:"dense",id:t.id,label:n+(d?"*":""),type:o,fullWidth:!0,onChange:function(e){return i&&i(e),t.onBlur(e.target.value)},name:t.name,error:!!p&&s,helperText:a,disabled:l,InputProps:u})),s&&p&&R.createElement(qe,{error:p}))}(e);case"datePicker":return function(e){var t=e.input,n=e.startDate,a=e.label,o=e.dateFormat,i=e.inputProps,l=e.meta,u=l.touched,c=l.error,s=je();return R.createElement("div",{className:s.formControl},R.createElement(q,L({},e,{customInput:R.createElement(r.TextField,{margin:"dense",fullWidth:!0,error:!!c&&u,label:a,InputProps:i}),error:!!c&&u,selected:t.value?t.value:n,onChange:function(e){return t.onChange(e)},dateFormat:o})),u&&c&&R.createElement(qe,{error:c}))}(e);case"fieldsGroupWrapper":return function(e){var t=e.children,r=(e.input,e.label,e.type,e.meta),n=r.touched,a=r.error;return R.createElement("div",null,t,n&&a&&R.createElement(qe,{error:a}))}(e);case"color":return function(e){var t=e.input,r=e.label,n=(e.type,e.meta),a=n.touched,o=n.error;return R.createElement("div",null,R.createElement(ee,{input:t,name:t.name,label:r}),a&&o&&R.createElement(qe,{error:o}))}(e);case"multiValueSelect":return console.log(e),function(e){var t=e.input,r=e.label,n=e.tableDefinition,a=e.labelProperties,o=e.groupOptionsBy,i=e.rawOptions,l=e.meta;l.touched,l.error;return R.createElement("div",null,R.createElement(De,{name:t.name,onChange:t.onChange,label:r,tableDefinition:n,labelProperties:a,rawOptions:i,groupOptionsBy:o}))}(e);default:return function(e){var t=e.input,r=e.label,n=e.type,a=e.meta,o=a.touched,i=a.error;return R.createElement("div",null,R.createElement("label",{htmlFor:t.name},r),R.createElement("div",null,R.createElement("input",L({},t,{placeholder:r,type:n})),o&&i&&R.createElement(qe,{error:i})))}(e)}var t,n,a,o,i,l,u},Ie=function(e){return R.createElement("div",{className:"form-item"},Re(e))};e.FieldCheckbox=Y,e.FieldColor=ee,e.FieldSelect=pe,e.LoadingBox=he,e.MultiValueSelect=De,e.RenderErrors=qe,e.SubmitButton=fe,e.Table=Se,e.renderField=Ie,Object.defineProperty(e,"__esModule",{value:!0})});
